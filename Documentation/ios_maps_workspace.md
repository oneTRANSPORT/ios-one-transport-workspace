# Using the OneTransportMaps workspace
Our demo workspace contains Objective-C and Swift examples of the oneM2M and oneTRANSPORT frameworks.

The oneTRANSPORTMaps workspace can be downloaded from [GitHub](https://github.com/oneTRANSPORT/ios-one-transport-workspace)


#Credentials

Before you can run the applications you will need to create an App in the oneTRANSPORT [Developer Portal](https://cse-01.onetransport.uk.net/portal/login) and replace the existing source code credentials with the following.

For Swift:

In AppDelegate.swift ensure that didFinishLaunchingWithOptions includes the following: 

		let APP_ID       = "<Your App Name>"
		let ACCCESS_KEY  = "<Your Access Key>"
		let ORIGIN       = "<Your AEID>"
	

For Objective-C:

In AppDelegate.m ensure that didFinishLaunchingWithOptions includes the following: 

	    NSString *APP_ID     = @"<Your App Name>";
	    NSString *APP_TOKEN  = @"<Your Access Key>";
	    NSString *APP_ORIGIN = @"<Your AEID>";

#Project Settings 
In the Project Settings for OTMap, OTPotHoles and OTObjCExample you will need to put in your own **Bundle Identifier** and **Developer Team**.

#The Projects

##OTMap
OTMap is the basis for an Apple Maps based application that displays local authority data as icons. 

###Menu Option - Map View

Displays a map of items/sensors with refresh and filter options. For convience, if a single local authority is selected the map will be positioned within that authority's area.

1. Filter by local authority and data type
2. Refresh the data set (the option disables itself for 30 seconds after being pressed)
3. Press to set a Map Rectangle Filter to the current map view bounds. Press again to clear the Map Rectangle Filter.
4. Tapping on an item icon displays basic information about the related Content Instance. 
	1. Tapping on Debug displays the CoreData records related to the item.
	2. Tapping on the Favourite icon toggles a local CoreData flag
5.	Scrolling and zooming the map will refresh the data set
	

###Menu Option - Map Filters

Display the map filter view controller.

###Menu Option - Favourites

Display the currently selected favourites along with a thumbnail view of the item/sensor location. To set favourites refer to MapView, option 4 (above).

###Menu Option - Bit Carrier / ClearView

Test the Bit Carrier and Clear View CSE requests and change the sensor names to request specific data.

1. Select **TSV Data** to import the TSV files into CoreData.
	
	1. Select **Load All** to clear and import all data from the TSVs.
	
	2. Select individual options to clear and import a particular data set.

	3. The TSV files are in the SampleData group within the Project.
	 
2. Select **ClearView Report** to display a graph of data based on the current CoreData set.
	
	1. Select **Show Dates** to see the range available within the current set.
	
	2. For the test data, try a range of 1 or 2 days at the beginning of the set to see the data more clearly.

	
 
###Menu Option - Settings

Modify settings and data within the app.

1. Set the refresh interval for the map view.

2. Set kph (kilometres per hour) or mph (miles per hour).

3. Flush the entire CoreData database.

4. See the current Map Rectangle Filter with the option to clear it.

5. Turn on/off the extended trace log for oneTRANSPORT HTTPS requests

6. See the current table record counts within CoreData.


###Menu Option - Example Request

A handy Swift view controller that matches the functionality of OTObjCExample.

1. A request through OTSingleton is made to return car park data for local authorities.

2. Completion blocks are prepared that will display an error or the contents of a successful response.

##OTPotHoles
OTPotHoles is a simplified app to demonstrate how to generate containers and store content in an AE (Application Entity). 

*Create* a new **Container** in your **AE**.

*Create* **Content Instances** within the **Container**.

Use *Discover* to list the **Content Instances** with the **Container** and then *Retrieve* the contents.

###Menu Option - Report Pot Hole

Within the XCode Simulator the app 'drives' around Buckinghamshire updating the app latitude/longitude. The user can enter a comment, set a severity level and submit the coordinates and additional information to the AE.

###Menu Option - View Pot Hole Container

As the view controller is displayed a request to the AE discovers all content instances and returns their contents.

###Menu Option - Create Pot Hole Container

As the view controller is displayed a request to the AE creates the pot hole container. An error is generated by the CSE if the container already exists.



##OTObjCExample
OTObjCExample is a single view controller app to demonstrate how to make requests through the oneTRANSPORT framework using Objective-C.

1. A completion block is prepared that will display an error or the contents of a successful response.

2. A single request through OTSingleton is made to return car park data for Birmingham.

